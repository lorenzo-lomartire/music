<!DOCTYPE html>
<html lang='en'>
	<head>
		<title>Music</title>
		<!--link rel='stylesheet' href='style.css'-->
		<meta charset='UTF-8'>
		<meta name='description' content='Lorenzo Lomartire â€” Music'>
		<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1" />
		<style>
			* {
				margin: 0;
			}
			body {
				height: 100vh;
			}
			main {
				height: inherit;
				display: flex;
				justify-content: space-around;
				align-items: center;
			}
			img {
				height: inherit;
			}
			#next {
				transform: rotate(0.5turn);
			}
			.preload {
				display: none;
			}
		</style>
	</head>
	<body theme='light'>
		<preload>
			<img src='icons/theme/light.svg'>
			<img src='icons/theme/dark.svg'>
		</preload>
		<header></header>
		<nav>
			<button class='icon' onclick='switchTheme()'>
				<img id='theme-icon' class='mono' src='icons/theme/light.svg' alt='switch theme from light to dark'>
			</button>
			<button id='homepage' class='url' onclick='navigate(location.origin)'>
				Homepage
			</button>
			<button id='music' class='url' onclick='navigate(location.origin + "/music")'>
				Music
			</button>
			<div class='empty'></div>
			<button class='icon' onclick='switchLang()'>
				<img id='lang-icon' src='icons/lang/en.svg' alt='switch language from english to italian'>
			</button>
		</nav>
		<main>
			<button id='prev'>&#11013;</button>
			<img id='main' alt='music'>
			<button id='next'>&#11013;</button>
			<img id='preload-prev' class='preload'></div>
			<img id='preload-next' class='preload'></div>
		</main>
		<footer></footer>
		<!--script type='text/javascript' src='script.js'></script-->
		<script>
			import('./resources/index.json', {
				assert: {
					type: 'json'
				}
			}).then((data) => {
				var root = './resources/';
				var main = data.default.Tchaikovsky;
				root += main.name + '/';
				main = main.data;
				root += main.name + '/';
				main = main.data;
				root += main.name + '/';
				root.split(' ').join('%20');
				var path = Object.entries(data.default.Tchaikovsky.data.data.data);
				path.map(el => {
					path[Number(el[0])] = el[1];
				});
				var current = 0;
				document.getElementById('main').src = root + path[current];
				if (current > 0) document.getElementById('preload-prev').src = root + path[current - 1];
				if (current < path.length - 1) document.getElementById('preload-next').src = root + path[current + 1];
				document.getElementById('prev').onclick = () => turn(0);
				document.getElementById('next').onclick = () => turn(1);
				function fetch(...keys) {
					let path = data.default;
					keys.map(key => {
						path = path[key];
					});
					return path;
				}
				function turn(direction) {
					let increment = direction ? 1 : -1;
					let limit = direction ? path.length - 1 : 0;
					current += ( current == limit ? 0 : increment );
					document.getElementById('main').src = root + path[current];
					if (current > 0) document.getElementById('preload-prev').src = root + path[current - 1];
					if (current < path.length - 1) document.getElementById('preload-next').src = root + path[current + 1];
				}
			});
		</script>
	</body>
</html>
